Emacs-Google-Calendar-Sync is a simple command line python script which syncronizes the emacs Diary with a Google calendar. 

INTRODUCTION

Emacs, because of its stability, portability and extensibility of features, remains a popular editor in todays age. Its calendar feature is simple and can be read and modified quickly and easily. Moreover, with the proliferation of portable pdas and netbook devices, it becomes convenient to be able to schedule google calendar events when an internet connection is temporarily not available. 
Details

This python script requires the email and password of the google calendar, either passed as arguments to the script, or entered as raw_input. The path to the emacs diary file must provided by editing the globalvar_DIARYFILE global variable at the begining of the script. Likewise, local timezone information and GMT offset must be provided in the same manner. 

Also, requires the GData library for python. 

FUNCTIONAL DEFINITION

Any new entries added to the Diary file will be inserted into the google calendar, and vice versa. If events in either the Diary file or the google calendar have been edited, these entries are deleted and new entries are inserted with their new respective values, and new eventids. If an event has been deleted from the Diary file, it in turn is deleted from the google calendar, and vice versa. 

If, before running this script, the same calendar entry has been edited by both the emacs diary as well as the Google Calendar, entry contention occurs upon syncing. By default, the script will interactively prompt you if this occurs (use the -p option if it does not) allowing you to choose which entry to keep and which to discard. Use option -n if you wish to do nothing about contending events; this allows for both entries to exist in both the Google calendar and emacs diary, but eliminates all user interaction, and so is preferable when used in conjunction with a crond like scheduler.

FUNCTIONAL CONSTRAINTS

Recurring events cannot have exceptions. 

The ending time of an event must procede midnight of the same day of the scheduled starting date; an event duration may not span past the days boundry delimiter, which is midnight. 

A copy or snapshot of the last sync of the Diary and Google calendar is stored in a shelve data file in the same directory as this script.

ISSUES/BUGS

error message: "Redirect received, but redirects_remaining <= 0" can occur accompanying many messages begining with the words, "redirects_remaining". If this happens, wait a few seconds and try the script again.  

If many empty entries are generated, or some entries are not being saved, try deleting the google calendar and running the script again.  Google sometimes has the problem of retaining deleted entries; for example when i've deleted 1 day out of a recurring event, and then deleted the recurring event, google will send that one day back as a schedule day when syncing.  I had to resort to deleting the calendar when that happend to correct it, which is one of the reasons why exceptions for recurring events are not yet supported.

the following recurrence cases arent working properly yet:
caseRecMonthlybydayofweekIntervalBlock
caseRecYearlyInterval -- this bug is on googles end
%%(diary-date t t t)

Diary formating styles are not yet preserved 

diary entries containing start time or end time of 12:00 am arent displaying properly.  Instead, the script currently converts an end time of 12:00 am to 12:00 pm.  But, on a positive note, the script recognizes 00:00 am as 12:00 am, which is a work around.

